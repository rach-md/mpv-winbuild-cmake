From 396ae516ae3ccbb38b923fe579dd989d4274d0eb Mon Sep 17 00:00:00 2001
From: rach-md <rach-md@users.noreply.github.com>
Date: Sat, 25 Nov 2023 09:19:11 +0800
Subject: [PATCH] fix compilation

---
 .gitmodules                 | 18 ------------------
 Makefile.am                 |  1 -
 bootstrap.conf              |  3 +--
 cfg.mk                      |  2 +-
 configure.ac                |  5 -----
 devel/import-from-nettle.sh |  2 +-
 doc/Makefile.am             |  6 +++---
 doc/reference/Makefile.am   | 10 +++++-----
 8 files changed, 11 insertions(+), 36 deletions(-)

diff --git a/.gitmodules b/.gitmodules
index ff0b12fa7..37f72c984 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -1,21 +1,6 @@
-[submodule "devel/openssl"]
-	path = devel/openssl
-	url = https://github.com/openssl/openssl.git
-[submodule "tests/suite/tls-fuzzer/tlsfuzzer"]
-	path = tests/suite/tls-fuzzer/tlsfuzzer
-	url = https://github.com/tomato42/tlsfuzzer.git
-[submodule "tests/suite/tls-fuzzer/python-ecdsa"]
-	path = tests/suite/tls-fuzzer/python-ecdsa
-	url = https://github.com/warner/python-ecdsa
-[submodule "tests/suite/tls-fuzzer/tlslite-ng"]
-	path = tests/suite/tls-fuzzer/tlslite-ng
-	url = https://github.com/tomato42/tlslite-ng.git
 [submodule "gnulib"]
 	path = gnulib
 	url = https://gitlab.com/libidn/gnulib-mirror.git
-[submodule "devel/nettle"]
-	path = devel/nettle
-	url = https://gitlab.com/gnutls/nettle.git
 [submodule "devel/libtasn1"]
 	path = devel/libtasn1
 	url = https://gitlab.com/gnutls/libtasn1.git
@@ -25,6 +10,3 @@
 [submodule "devel/cligen"]
 	path = cligen
 	url = https://gitlab.com/gnutls/cligen.git
-[submodule "tests/suite/tls-interoperability"]
-	path = tests/suite/tls-interoperability
-	url = https://gitlab.com/redhat-crypto/tests/interop.git
diff --git a/Makefile.am b/Makefile.am
index 843193f9f..406d55787 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -20,7 +20,6 @@
 
 AM_DISTCHECK_CONFIGURE_FLAGS = \
 	--enable-doc \
-	--enable-gtk-doc \
 	--disable-valgrind-tests
 
 SUBDIRS = gl lib extra
diff --git a/bootstrap.conf b/bootstrap.conf
index c4d1fe06b..abfea451d 100644
--- a/bootstrap.conf
+++ b/bootstrap.conf
@@ -23,7 +23,7 @@ gnulib_tool_option_extras="--without-tests --avoid=alignof-tests --avoid=lock-te
 use_libtool=1
 checkout_only_file=
 local_gl_dir=gl/override/
-required_submodules="tests/suite/tls-fuzzer/python-ecdsa tests/suite/tls-fuzzer/tlsfuzzer tests/suite/tls-fuzzer/tlslite-ng tests/suite/tls-interoperability cligen devel/abi-dump devel/nettle devel/openssl devel/libtasn1"
+required_submodules="cligen devel/abi-dump devel/libtasn1"
 
 # Those modules are common to lib/ and src/.
 common_modules="
@@ -50,7 +50,6 @@ git        1.4.4
 perl       5.5
 gperf      -
 autopoint  -
-gtkdocize  -
 "
 
 # update git submodules
diff --git a/cfg.mk b/cfg.mk
index 8cef05a7c..2cae4f1e3 100644
--- a/cfg.mk
+++ b/cfg.mk
@@ -19,7 +19,7 @@
 
 WFLAGS ?= --enable-gcc-warnings
 ADDFLAGS ?=
-CFGFLAGS ?= --enable-gtk-doc --enable-gtk-doc-pdf --enable-gtk-doc-html $(ADDFLAGS) $(WFLAGS)
+CFGFLAGS ?= $(ADDFLAGS) $(WFLAGS)
 PACKAGE ?= gnutls
 
 .PHONY: config glimport
diff --git a/configure.ac b/configure.ac
index 4c898b35a..a30c435d7 100644
--- a/configure.ac
+++ b/configure.ac
@@ -386,11 +386,6 @@ if test "$enable_fuzzer_target" != "no";then
 	AC_DEFINE([FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION], 1, [Enable fuzzer target -not for production])
 fi
 
-dnl
-dnl check for gtk-doc
-dnl
-GTK_DOC_CHECK([1.14],[--flavour no-tmpl])
-
 AM_GNU_GETTEXT([external])
 AM_GNU_GETTEXT_VERSION([0.19])
 m4_ifdef([AM_GNU_GETTEXT_REQUIRE_VERSION],[
diff --git a/devel/import-from-nettle.sh b/devel/import-from-nettle.sh
index ac3dd5fbf..61d6ef0c6 100755
--- a/devel/import-from-nettle.sh
+++ b/devel/import-from-nettle.sh
@@ -6,7 +6,7 @@
 set +e
 
 : ${srcdir=.}
-SRC=$srcdir/devel/nettle
+SRC=../nettle
 DST=$srcdir/lib/nettle/backport
 
 IMPORTS="
diff --git a/doc/Makefile.am b/doc/Makefile.am
index 90fab522f..5f48470a1 100644
--- a/doc/Makefile.am
+++ b/doc/Makefile.am
@@ -33,9 +33,9 @@ IMAGES = \
 	pkcs11-vision.png
 
 SUBDIRS = examples scripts credentials latex
-if ENABLE_GTK_DOC
-SUBDIRS += reference
-endif
+#if ENABLE_GTK_DOC
+#SUBDIRS += reference
+#endif
 
 -include $(top_srcdir)/doc/doc.mk
 
diff --git a/doc/reference/Makefile.am b/doc/reference/Makefile.am
index f10c8ed3c..4331f2921 100644
--- a/doc/reference/Makefile.am
+++ b/doc/reference/Makefile.am
@@ -84,11 +84,11 @@ EXTRA_DIST += version.xml.in
 
 # Comment this out if you want 'make check' to test you doc status
 # and run some sanity checks
-if ENABLE_GTK_DOC
-TESTS_ENVIRONMENT = \
-  DOC_MODULE=$(DOC_MODULE) DOC_MAIN_SGML_FILE=$(DOC_MAIN_SGML_FILE) \
-  SRCDIR=$(abs_srcdir) BUILDDIR=$(abs_builddir)
+#if ENABLE_GTK_DOC
+#TESTS_ENVIRONMENT = \
+#  DOC_MODULE=$(DOC_MODULE) DOC_MAIN_SGML_FILE=$(DOC_MAIN_SGML_FILE) \
+#  SRCDIR=$(abs_srcdir) BUILDDIR=$(abs_builddir)
 #TESTS = $(GTKDOC_CHECK)
-endif
+#endif
 
 -include $(top_srcdir)/git.mk
-- 
2.42.0

